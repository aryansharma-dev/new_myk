import{r as a,S as N,d as v,c as C,j as t,b as h,B as g}from"./index-Du1wZ1pu.js";import{u as L}from"./usePageMetadata-CED4SOpM.js";function T(l){try{localStorage.setItem("token",l||"")}catch(n){console.warn("Unable to persist auth token",n)}}function E(){var x;const{setToken:l,token:n}=a.useContext(N),[s,m]=a.useState("Login"),[d,y]=a.useState(""),[c,w]=a.useState(""),[u,S]=a.useState(""),b=v(),p=C(),j=((x=b.state)==null?void 0:x.from)||"/";L({title:s==="Sign Up"?"Create a TinyMillion Account":"Sign in to TinyMillion",description:"Access TinyMillion orders, track deliveries, and unlock creator mini stores by logging in or creating an account.",keywords:"TinyMillion login, TinyMillion signup, customer account",canonical:"/login",robots:"noindex, nofollow",structuredData:({absoluteCanonical:o,baseTitle:i})=>[{"@context":"https://schema.org","@type":s==="Sign Up"?"RegisterAction":"LoginAction","@id":`${o}#auth`,name:i,target:o}]});const k=async o=>{var i,f;o.preventDefault();try{let r;s==="Sign Up"?r=await h.post("/api/user/register",{name:d,email:c,password:u}):r=await h.post("/api/user/login",{email:c,password:u});const e=r.data;e!=null&&e.success&&(e!=null&&e.token)?(T(e.token),l(e.token),g.success(`${s} successful!`),p(j,{replace:!0})):g.error((e==null?void 0:e.message)||`${s} failed`)}catch(r){const e=((f=(i=r==null?void 0:r.response)==null?void 0:i.data)==null?void 0:f.message)||r.message||`${s} failed`;g.error(e)}};return a.useEffect(()=>{n&&p("/")},[n,p]),t.jsxs("form",{onSubmit:k,className:"flex flex-col items-center w-[90%] sm:max-w-96 m-auto mt-14 gap-4 text-gray-800",children:[t.jsxs("div",{className:"inline-flex items-center gap-2 mb-2 mt-10",children:[t.jsx("p",{className:"prata-regular text-3xl",children:s}),t.jsx("hr",{className:"border-none h-[1.5px] w-8 bg-gray-800"})]}),s==="Sign Up"&&t.jsx("input",{onChange:o=>y(o.target.value),value:d,type:"text",className:"w-full px-3 py-2 border border-gray-800",placeholder:"Name",required:!0}),t.jsx("input",{onChange:o=>w(o.target.value),value:c,type:"email",className:"w-full px-3 py-2 border border-gray-800",placeholder:"Email",required:!0}),t.jsx("input",{onChange:o=>S(o.target.value),value:u,type:"password",className:"w-full px-3 py-2 border border-gray-800",placeholder:"Password",required:!0}),t.jsxs("div",{className:"w-full flex justify-between text-sm mt-[-8px]",children:[t.jsx("p",{className:"cursor-pointer",children:"Forgot your password?"}),s==="Login"?t.jsx("p",{onClick:()=>m("Sign Up"),className:"cursor-pointer",children:"Create account"}):t.jsx("p",{onClick:()=>m("Login"),className:"cursor-pointer",children:"Login Here"})]}),t.jsx("button",{className:"bg-black text-white font-light px-8 py-2 mt-4",children:s==="Login"?"Sign In":"Sign Up"})]})}export{E as default};
